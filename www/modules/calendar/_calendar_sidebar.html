<div class="pane-header scroll-header">
    <span class="pane-title">My Calendars</span>
    <span ng-hide="addingSubscription" class="icon-plus-alt right" ng-click="add()" aria-hidden="true"></span>
    <span ng-show="addingSubscription" class="icon-x-altx-alt right" ng-click="cancel()" aria-hidden="true"></span>
</div>
<div ng-show="loading_calendars" class="spinwheel"></div>
<!-- Calendar Admin box -->
<div id="calendar-admin-modal-bg" class="reveal-modal-bg"></div>
<div id="calendar-admin-modal" class="reveal-modal medium" style="position:fixed; color:black; padding: 0 0 20px 0;">
	<h2>Calendar Administration</h2>
	<h3>{{calendar.calendar_name}}</h3>
	<div class="large-4 columns left">
		<div ng-repeat="admin in calendar.admins">
			<div class="large-8 small-12 columns" style="line-height:42px; white-space:nowrap;">
				{{admin.first_name}} {{admin.last_name}} : {{admin.user_handle}}			
			</div>
			<div class="large-2 small-12 columns">
				<button ng-click="deleteCalendarAdmin(admin)" class="icon modalTrigger button radius" button-icon="icon-remove2">
					<span aria-hidden="true" class="icon-remove2"></span>
				</button>
<!-- 			<confirm
					button-icon="icon-remove-2"
					button-class="button radius"
					header="Delete Calendar Administrator"
					body="Are you sure you want to delete this calendar adminstrator?"
					footer="You are about to delete a calendar adminstrator.  Are you sure you wnat to continue?"
					affirmative-text="Confirm"
					negative-text="Cancel"
					affirmative-action="deleteCalendarAdmin(admin)"
					negative-action="cancelDeleteCalendarAdmin()">
				</confirm> -->
			</div>
		</div>
	</div>
	<div class="large-8 columns right">
		<div class="large-12 columns" ng-show="createNewCalendarAdmin">
			<div class="large-4 columns clear left">Username:</div><div class="large-8 columns right"><input type="text" ng-model="newAdmin.username" /></div>
			<div class="large-12 columns centered alert" ng-show="existingAdmin"><span class='error'>User is already a Calendar Administrator</span></div>
			<div class="large-6 columns">
				<div class="expand small alert button" ng-click="createNewCalendarAdmin = false" >Cancel</div>
			</div>
			<div class="large-6 columns">
				<div class="expand small success button" ng-click="addCalendarAdmin()" >Add</div>
			</div>
		</div>
		<div class="large-12 columns" ng-show="!createNewCalendarAdmin">
			<div class="button" ng-click="createNewCalendarAdmin = true">
				<span aria-hidden="true" class="icon-plus-alt"> Add new Contact Point</span>
			</div> 
		</div>
	</div>
	<a class="close-reveal-modal"><span aria-hidden="true" class="icon-x-altx-alt"></span></a>
</div> 
<!-- END Calendar Admin box -->
<!-- SUBSCRIBED CALENDAR SECTION -->
<div scroll-pane class="scroll-pane left">
	<!-- existing calendars ng-repeat -->
	<active-subscription
		ng-repeat="calendar in subscribedCalendars = (calendars | filter:{active: true, subscribed: true} | orderBy:'calendar_name')" 
		watcher="calendarWatchers"
		calendar="calendar"
		user="user"
		reminder-types="reminderTypes"
		reminders="reminders[$index]">
	</active-subscription>
	<!-- / existing calendars ng-repeat -->
</div>

<!-- ADD CALENDAR SECTION -->
<div id="add-calendar" class="transition duration-700 slide-drawer show-header full bottom-up" ng-class="{open: addingSubscription}">
	<div scroll-pane class="scroll-pane left">
		<!-- RECENTLY CREATED/SUBSCRIBED CALENDAR SECTION
		<div ng-show="recentCalendars.length" class="pane-header small" style="border-top: 1px solid #afafaf;">
	        <span class="pane-title">Recently Added</span>
	    </div> -->

		<!-- recently acquired calendars ng-repeat -->
		<active-subscription
			ng-repeat="calendar in recentCalendars = (calendars | filter:{active: true, recent: true, subscribed: true} | orderBy:'calendar_name')"
			watcher="calendarWatchers"
			user="user"
			calendar="calendar"
			reminder-types="reminderTypes">
		</active-subscription>

		<!-- / RECENTLY CREATED/SUBSCRIBED CALENDAR SECTION -->

	    <!-- NEW CALENDAR CREATION FORM -->
	    <div
		    resource-panel="addingCalendar"
		    class="resource-panel existing"
		    ng-class="{'open':addingCalendar, 'close':!addingCalendar}"
		    ng-style="{background:newCalendar.color}"
		    style="border-bottom: 0 !important;">
			<div class="resource-gradient">
				<div class="resource-header pane-header small">
				    <span ng-hide="newCalendar.calendar_name" class="pane-title">New Calendar</span>
				    <span ng-show="newCalendar.calendar_name" class="pane-title">{{newCalendar.calendar_name}}</span>
				    <span class="icon-x-altx-alt right" ng-click="cancelNew()" aria-hidden="true"></span>
				</div>
				<div class="resource-body">
					<!-- DISPLAY -->
					<div class="resource-display">
						<label class="checkbox resource-checkbox">
							<span class="icon-calendarPlus" aria-hidden="true"></span>
						</label>
						<div class="resource-data" ng-click="addNew()">
							<strong class="resource-title">
								New Calendar
							</strong>
						</div>
					</div>
					<!-- / DISPLAY -->

					<!-- EDIT -->
					<form class="subscription resource-edit" name="newCalendarForm" novalidate>
						<!-- Name -->
						<div class="row" style="padding-top: 1em;">
							<div class="large-12 columns">
								<div class="resource-name">
									<input required type="text" focus-me="[editingCalendar]" delay="500" ng-model="newCalendar.calendar_name" placeholder="Name (required)" />
								</div>
								<div class="color-selector">
									<ui-colorpicker ng-model="newCalendar.color"></ui-colorpicker>
								</div>
							</div>
						</div>

						<!-- Public Checkbox -->
						<div class="row" ng-show="hasPublic = checkPermision('modify_public_calendars',true)">
							<div class="large-12 columns">
								<checkbox
									ng-model="newCalendar.public"
									text="This is a public calendar" 
								/>
							</div>
						</div>

						<!-- Reminders -->
						<reminder-list reminders="reminders"></reminder-list>

						<div class="row">
							<div class="large-12 columns">
								<ul class="button-group even-2">
									<li>
										<button class="button radius" ng-click="cancelNew()">
											<span aria-hidden="true" class="icon-remove-2"></span> <!-- unsubscribe -->
										</button>
									</li>
									<li style="padding-right: 0;">
										<button ng-disabled="newCalendarForm.$invalid" class="button radius" ng-click="update()">
											<span aria-hidden="true" class="icon-checkmark"></span> <!-- save -->
										</button>
									</li>
								</ul>
							</div>
						</div>
					</form>
					<!-- / EDIT -->
				</div>
			</div>
		</div>
		<!-- / NEW CALENDAR CREATION FORM -->

		<!-- AVAILABLE CALENDAR SECTION -->
		<div style="position: relative; width: 50%; margin-right: 50%;">
			<div class="pane-header small" style="border-top: 1px solid #afafaf;">
		        <span class="pane-title">Available</span>
		    </div>
			<input style="margin: 0;" type="text" ng-model="calFilter" placeholder="Search Calendars" />
			<span style="position: absolute; top: 30px; right: 6px; font-size: 24px; color: #d4d4d4;" aria-hidden="true" class="icon-backspace" ng-click="calFilter=''"></span>
		</div>

		<div class="resource-panel" style="background: black;" ng-hide="availableCalendars.length">
			<div class="resource-gradient">
				<div class="resource-body">
					<div class="resource-display">
						<div class="resource-data">
							<strong class="resource-title">
								None
							</strong>
						</div>
					</div>
				</div>
			</div>
		</div>

		<available-subscription
			ng-repeat="calendar in availableCalendars = (calendars | filter:{active: true, subscribed: false} | filter:calFilter | orderBy:'calendar_name')"
			watcher="calendarWatchers"
			user="user"
			calendar="calendar">
		</available-subscription>
		<!-- / AVAILABLE CALENDAR SECTION -->
	</div><!--
	<div scroll-pane-two class="scroll-pane" watch="recentCalendars.length" style="overflow-y: auto;">
		<available-subscription
			ng-repeat="calendar in availableCalendars = (calendars | filter:{active: true, subscribed: false} | filter:calFilter | orderBy:'calendar_name')"
			watcher="calendarWatchers"
			user="user"
			calendar="calendar">
		</available-subscription>
	</div>-->
</div>
